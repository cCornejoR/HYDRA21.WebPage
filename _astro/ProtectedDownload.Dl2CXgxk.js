import{j as w}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BVOCwoKb.js";function E({children:d,downloadUrl:o,className:i="",onAuthRequired:p=null}){const[c,n]=r.useState(!1);r.useEffect(()=>{const t=()=>{const m=sessionStorage.getItem("hydra_download_auth")==="true",l=sessionStorage.getItem("hydra_download_token"),a=sessionStorage.getItem("hydra_download_timestamp"),h=Date.now();(a?h-parseInt(a):1/0)>24*60*60*1e3?(sessionStorage.removeItem("hydra_download_auth"),sessionStorage.removeItem("hydra_download_token"),sessionStorage.removeItem("hydra_download_timestamp"),n(!1)):n(m&&l)};t();const e=()=>t();window.addEventListener("storage",e);const s=()=>t();return window.addEventListener("auth-success",s),()=>{window.removeEventListener("storage",e),window.removeEventListener("auth-success",s)}},[]);const u=t=>{if(t.preventDefault(),t.stopPropagation(),c){if(o){const e=document.createElement("a");e.href=o,e.download="",e.target="_blank",e.rel="noopener noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}else{const e=new CustomEvent("show-auth-modal",{detail:{downloadUrl:o}});window.dispatchEvent(e)}};return w.jsx("div",{onClick:u,className:i,style:{cursor:"pointer"},children:d})}export{E as default};
